{% extends "layout.html.twig" %}

{% block header %}
	<header class="page-header">
		<nav class="page-header-nav">
			<a class="link-logo-GIFL" href="index.php"><img class="logo-GIFL" src="../assets/images/logoGIFL.png" alt="GIFL Home page"></a>


			{% if session.email is defined %}
				<div class="header-session-info">
					<img class="page-header-avatar" src="{{session.avatar}}" alt="">
					<p>{{session.name}}</p>
				</div>

				<div class="arrow-burger-container">
					<img class="arrow-yellow" src="../assets/images/Triangle-yellow.svg" alt="">
					<img class="arrow-pink" src="../assets/images/Triangle-pink.svg" alt="">
				</div>

				<div class="links-wrapper">
					<a class="header-link top-border-link" href="index.php?route=search">My collections</a>
					<a class="header-link top-border-link" href="index.php?route=search">Search</a>
					<a class="header-link top-border-link" href="index.php?route=search">Upload</a>

					{% if session.admin %}
						<a class="header-link top-border-link" href="index.php?route=back-office">Back-Office</a>

					{% endif %}
					<a class="header-link full-border-link" href="index.php?route=search">Parameters</a>

				</div>
			{% else %}
				<div class="links-wrapper">
					<a class="header-link full-border-link" href="index.php?route=search">Search</a>
				</div>
			{% endif %}

			{% if session.email is defined %}
				<a class="header-link disconnect-link" href="index.php?route=check-sign-out">Disconnect</a>
			{% endif %}
		</nav>
	</header>
{% endblock %}


{% block main %}
	<main>
		<h1>Back-office</h1>
		{% if user is defined %}
			<h2>Update User</h2>
			<form class="sign-form" action="index.php?route=update-user&user={{user.id}}" method="post">
				<input type="hidden" name="csrf-token" id="csrf-token" value="{{session.csrfToken}}"/>

				<div class="sign-form-input-wrapper">
					<label class="form-label" for="email">Email</label>
					<input class="form-input" type="email" name="email" id="email" value={{user.email}} required>
				</div>
				<div class="sign-form-input-wrapper">

					<label class="form-label" for="name">Name</label>
					<input class="form-input" type="text" name="name" id="name" value={{user.name}} required>
				</div>

				<div class="sign-form-input-wrapper avatar">

					<label class="form-label" for="avatar">Avatar (optionnal)</label>
					<input class="form-input" type="avatar" name="avatar" id="avatar" value={{user.avatar}}>
				</div>

				<button class="yellow-button small-button" type="submit">Update user</button>
			</form>
		{% else %}


			<h2>Create User</h2>
			<form class="sign-form" action="index.php?route=check-sign-up" method="post">
				<input type="hidden" name="csrf-token" id="csrf-token" value="{{session.csrfToken}}"/>
				<div class="sign-form-input-wrapper">
					<label class="form-label" for="email">Email</label>
					<input class="form-input" type="email" name="email" id="email" required>
				</div>
				<div class="sign-form-input-wrapper">

					<label class="form-label" for="name">Name</label>
					<input class="form-input" type="text" name="name" id="name" required>
				</div>
				<div class="sign-form-input-wrapper">

					<label class="form-label" for="password">Password</label>
					<input class="form-input" type="password" name="password" id="password" required>
				</div>
				<div class="sign-form-input-wrapper">

					<label class="form-label" for="password-confirm">Password confirm</label>
					<input class="form-input" type="password" name="password-confirm" id="password-confirm" required>
				</div>
				<div class="sign-form-input-wrapper avatar">

					<label class="form-label" for="avatar">Avatar (optionnal)</label>
					<input class="form-input" type="avatar" name="avatar" id="avatar">
				</div>
				<button class="yellow-button small-button" type="submit">Create User</button>
			</form>
		{% endif %}

		<h2>Users</h2>
		<table>
			<thead>
				<tr>
					<th>
						#
					</th>
					<th>
						Email
					</th>
					<th>
						Name
					</th>
					<th>
						Password
					</th>
					<th>
						Admin
					</th>
					<th>
						Update
					</th>
					<th>
						Delete
					</th>
				</tr>
			</thead>
			<tbody>
				{% for user in users %}
					<tr>
						<td>{{user.id}}</td>
						<td>{{user.email}}</td>
						<td>{{user.name}}</td>
						<td>{{user.password}}</td>
						<td>{{user.admin}}</td>
						{% if user.id == 1 %}
							<td>---</td>
							<td>---</td>
						{% else %}
							<td>
								<a href="index.php?route=update-user&user={{user.id}}">Update</a>
							</td>
							<td>
								<a href="index.php?route=delete-user&user={{user.id}}">Delete</a>
							</td>
						{% endif %}
					</tr>

				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<th>
						#
					</th>
					<th>
						Email
					</th>
					<th>
						Name
					</th>
					<th>
						Password
					</th>
					<th>
						Admin
					</th>
					<th>
						Update
					</th>
					<th>
						Delete
					</th>
				</tr>
			</tfoot>
		</table>
	</main>
{% endblock %}
